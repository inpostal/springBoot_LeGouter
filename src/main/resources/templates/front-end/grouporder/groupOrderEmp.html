<!doctype html>
<html lang="zxx">


<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/bootstrap.min.css">
    <!-- Owl Theme Default CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/owl.theme.default.min.css">
    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/owl.carousel.min.css">
    <!-- Owl Magnific CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/magnific-popup.css">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/animate.css">
    <!-- Boxicons CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/boxicons.min.css">
    <!-- Flaticon CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/flaticon.css">
    <!-- Meanmenu CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/meanmenu.css">
    <!-- Nice Select CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/nice-select.css">
    <!-- Odometer CSS-->
    <link rel="stylesheet" href="/GroupOrder/assets/css/odometer.css">
    <!-- Style CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/style.css">
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="/GroupOrder/assets/css/responsive.css">

    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="/GroupOrder/static/css/css2.css" rel="stylesheet">

    <link href="/GroupOrder/static/css/all.min.css" rel="stylesheet">
    <link href="/GroupOrder/static/css/bootstrap-icons.css" rel="stylesheet">

    <link href="/GroupOrder/static/css/animate.min.css" rel="stylesheet">
    <link href="/GroupOrder/static/css/owl.carousel.min.css" rel="stylesheet">

    <link href="/GroupOrder/static/css/bootstrap.min.css" rel="stylesheet">

    <link href="/GroupOrder/static/css/style.css" rel="stylesheet">


    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/GroupOrder/assets/img/favicon.png">
    <!-- Title -->
    <title>Eduon</title>
    <style>
        .nav-tabs .nav-link {
            margin-bottom: -1px;
            background: none;
            border: 1px solid transparent;
            border-top-left-radius: 6px;
            border-top-right-radius: 6px;
            width: 562px;
            height: 90px;
            font-size: 20px;
        }

        .table > :not(:last-child) > :last-child > * {
            border-bottom-color: white;
        }

        .table td, .table th {
            padding: 0.75rem;
            vertical-align: top;
            border-top: 1px solid #dee2e6;
            text-align: center;
        }

        .single-news .news-content .lessons {
            border-top: 0px solid #ebebeb;
            font-size: 18px;
        }

        .card {
            flex-direction: row;
            justify-content: space-evenly;
        }

        .my-span {
            margin-right: 5px; /* 设置右侧间距为 5px */
        }


    </style>
</head>

<body>
<!-- Start Preloader Area -->
<div id="spinner"
     class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
    <div class="spinner-grow text-primary" role="status"></div>
</div>


<div class="container-fluid top-bar bg-dark text-light px-0 wow fadeIn" data-wow-delay="0.1s">
    <div class="row gx-0 align-items-center d-none d-lg-flex">
        <div class="col-lg-6 px-5 text-start">
            <ol class="breadcrumb mb-0">
                <!-- <li class="breadcrumb-item"><a class="small text-light" href="#">Home</a></li>
                <li class="breadcrumb-item"><a class="small text-light" href="#">Career</a></li>
                <li class="breadcrumb-item"><a class="small text-light" href="#">Terms</a></li>
                <li class="breadcrumb-item"><a class="small text-light" href="#">Privacy</a></li> -->
            </ol>
        </div>
        <div class="col-lg-6 px-5 text-end">
            <small>Follow us:</small>
            <div class="h-100 d-inline-flex align-items-center">
                <a class="btn-lg-square text-primary border-end rounded-0" href=""><i
                        class="fab fa-facebook-f"></i></a>
                <a class="btn-lg-square text-primary border-end rounded-0" href=""><i
                        class="fab fa-twitter"></i></a>
                <a class="btn-lg-square text-primary border-end rounded-0" href=""><i
                        class="fab fa-linkedin-in"></i></a>
                <a class="btn-lg-square text-primary pe-0" href=""><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>
</div>

<!-- 導覽列 -->

<!-- 頁首 -->
<div th:insert="front-end/components/Header :: #header-div"></div>
<!-- 導覽列 -->
<div th:insert="front-end/components/NavBar :: #nav-bar"></div>

<!-- Start Page Title Area -->
<div class="page-title-area bg-4">
    <div class="container">
        <div class="page-title-content">
            <h2>團購主專區</h2>

            <ul>
                <li>
                    <a th:href="@{/LeGouter}">
                        Home
                    </a>
                </li>

                <li class="active">團購主</li>
            </ul>
        </div>
    </div>
</div>






<!-- End Page Title Area -->


<ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button"
                role="tab" aria-controls="home" aria-selected="true">個人訂單
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button"
                role="tab" aria-controls="profile" aria-selected="false">團購主團購活動
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button"
                role="tab" aria-controls="contact" aria-selected="false">團購主分潤
        </button>
    </li>
</ul>
<div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
        <div class="col py-3">
            <!-- 由此開始 -->


            <hr>
            <div class="from-row">
                <div class="card-body">
                    <div class="table-responsive">
                        <div class="text-end mb-3">
                            關鍵字搜尋 <input type="search" class="light-table-filter" data-table="order-table"
                                              placeholder="請輸入關鍵字">
                        </div>
                        <!--                        <p style="display: none" th:text="${user.getMemberId()}" id="memberId"></p>-->
                        <table class="order-table table">
                            <thead>
                            <tr style="background-color: #f8d3ae;color:#1E1916;">
                                <th> 訂單編號</th>
                                <th>訂單狀態</th>
                                <th>付款方式</th>
                                <th>訂購數量</th>
                                <th>商品單價</th>
                                <th>商品總金額</th>

                            </tr>
                            </thead>
                            <tbody id="grouporderdetail">

                            </tbody>
                        </table>
                        <hr>

                    </div>

                </div>
            </div>

            <div class="col-lg-12 col-md-12 d-flex pagination-bar"></div>

        </div>
    </div>
    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">

        <div class="blog-column-three-area ptb-100">
            <div class="container">
                <div class="row" id="groupOrderContainer">

                </div>

            </div>
        </div>
    </div>
    <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">

        <div class="col py-3">
            <!-- 由此開始 -->

            <div class="from-row">
                <div class="d-flex justify-content-between">

                </div>
                <hr>
                <div class="from-row">
                    <div class="card-body">
                        <div class="table-responsive">

                            <div class="text-end mb-3">
                                關鍵字搜尋 <input type="search" class="light-table-filter" data-table="order-table"
                                                  placeholder="請輸入關鍵字">
                            </div>
                            <table class="order-table table">
                                <thead>
                                <tr style="background-color: #f8d3ae;color:#1E1916;">
                                    <th>訂單資訊</th>
                                    <th>團購狀態</th>
                                    <th>訂單金額</th>
                                    <th>分潤比例</th>
                                    <th>分潤金額</th>
                                    <th>分潤狀態</th>
                                </tr>
                                </thead>
                                <tbody id="grouporderfrontbonus">

                                </tbody>
                            </table>
                            <hr>
                            <div id="selectedCount"></div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="col-lg-12 col-md-12">
        <div class="pagination-area">
            <!--
                        <a href="#" class="prev page-numbers">
                            <i class="bx bx-chevron-left"></i>
                        </a>
                        -->
            <span class="page-numbers current" aria-current="page">1</span>
            <a href="#" class="page-numbers">2</a>
            <a href="#" class="page-numbers">3</a>
            <a href="#" class="page-numbers">4</a>

            <a href="#" class="next page-numbers">
                <i class="bx bx-chevron-right"></i>
            </a>
        </div>
    </div>
</div>
</div>
</div>
<!-- End Blog Column Three Area -->

<!-- Start Footer Top Area -->
<div class="container-fluid bg-dark text-light footer my-6 mb-0 py-5 wow fadeIn" data-wow-delay="0.1s">
    <div class="container py-5">
        <div class="row g-5">
            <div class="col-lg-3 col-md-6">
                <h4 class="text-light mb-4">粉絲專頁</h4>

                <div class="d-flex pt-2">
                    <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i
                            class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-square btn-outline-light rounded-circle me-0" href=""><i
                            class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <h4 class="text-light mb-4">快速連結</h4>
                <a class="btn btn-link" href="">品牌故事</a>
                <a class="btn btn-link" href="">聯絡我們</a>
                <a class="btn btn-link" href="">服務與條款</a>
            </div>

            <div class="col-lg-3 col-md-6">
                <h4 class="text-light mb-4">常見問題</h4>
                <a class="btn btn-link" href="">FAQ</a>
                <a class="btn btn-link" href="">回報客服</a>
            </div>

            <div class="col-lg-3 col-md-6">
                <h4 class="text-light mb-4">甜點畫廊</h4>
                <div class="row g-2">
                    <div class="col-4">
                        <img class="img-fluid bg-light rounded p-1" src="/GroupOrder/static/picture/product-1.jpg"
                             alt="Image">
                    </div>
                    <div class="col-4">
                        <img class="img-fluid bg-light rounded p-1" src="/GroupOrder/static/picture/product-2.jpg"
                             alt="Image">
                    </div>
                    <div class="col-4">
                        <img class="img-fluid bg-light rounded p-1" src="/GroupOrder/static/picture/product-3.jpg"
                             alt="Image">
                    </div>
                    <div class="col-4">
                        <img class="img-fluid bg-light rounded p-1" src="/GroupOrder/static/picture/product-2.jpg"
                             alt="Image">
                    </div>
                    <div class="col-4">
                        <img class="img-fluid bg-light rounded p-1" src="/GroupOrder/static/picture/product-3.jpg"
                             alt="Image">
                    </div>
                    <div class="col-4">
                        <img class="img-fluid bg-light rounded p-1" src="/GroupOrder/static/picture/product-1.jpg"
                             alt="Image">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script data-cfasync="false" src="/GroupOrder/static/js/email-decode.min.js"></script>
<script src="/GroupOrder/static/js/jquery-3.4.1.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/bootstrap.bundle.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/wow.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/easing.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/waypoints.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/counterup.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/owl.carousel.min.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>

<script src="/GroupOrder/static/js/main.js" type="0080e6b992b21508d4c0eeae-text/javascript"></script>
<script src="/GroupOrder/static/js/rocket-loader.min.js" data-cf-settings="0080e6b992b21508d4c0eeae-|49"
        defer=""></script>
<!-- End Footer Top Area -->


<!-- Start Go Top Area -->

<!-- End Go Top Area -->
<!-- 頁腳 -->
<div th:insert="front-end/components/Footer :: #footer-div"></div>
<!-- 版權所有 -->
<div th:insert="front-end/components/Copyright :: #copyright-div"></div>

<!-- Jquery-3.5.1.Slim.Min.JS -->
<script src="/GroupOrder/assets/js/jquery-3.5.1.slim.min.js"></script>
<!-- Popper JS -->
<script src="/GroupOrder/assets/js/popper.min.js"></script>
<!-- Bootstrap JS -->
<script src="/GroupOrder/assets/js/bootstrap.min.js"></script>
<!-- Meanmenu JS -->
<script src="/GroupOrder/assets/js/jquery.meanmenu.js"></script>
<!-- Wow JS -->
<script src="/GroupOrder/assets/js/wow.min.js"></script>
<!-- Owl Carousel JS -->
<script src="/GroupOrder/assets/js/owl.carousel.js"></script>
<!-- Owl Magnific JS -->
<script src="/GroupOrder/assets/js/jquery.magnific-popup.min.js"></script>
<!-- Nice Select JS -->
<script src="/GroupOrder/assets/js/jquery.nice-select.min.js"></script>
<!-- Parallax JS -->
<script src="/GroupOrder/assets/js/parallax.min.js"></script>
<!-- Appear JS -->
<script src="/GroupOrder/assets/js/jquery.appear.js"></script>
<!-- Odometer JS -->
<script src="/GroupOrder/assets/js/odometer.min.js"></script>
<!-- Form Validator JS -->
<script src="/GroupOrder/assets/js/form-validator.min.js"></script>
<!-- Contact JS -->
<script src="/GroupOrder/assets/js/contact-form-script.js"></script>
<!-- Ajaxchimp JS -->
<script src="/GroupOrder/assets/js/jquery.ajaxchimp.min.js"></script>
<!-- Custom JS -->
<script src="/GroupOrder/assets/js/custom.js"></script>

<script src="/News/Yen_js/jquery-3.4.1.min.js"></script>
</body>
<script>
    //關鍵字搜尋
    $(document).ready(function () {
        'use strict';
        var LightTableFilter = (function (Arr) {
            var _input;
            function _onInputEvent(e) {
                _input = e.target;
                var tables = document.getElementsByClassName(_input.getAttribute('data-table'));
                Arr.forEach.call(tables, function (table) {
                    Arr.forEach.call(table.tBodies, function (tbody) {
                        Arr.forEach.call(tbody.rows, _filter);
                    });
                });
            }

            function _filter(row) {
                var text = row.textContent.toLowerCase(),
                    val = _input.value.toLowerCase();
                row.style.display = text.indexOf(val) === -1 ? 'none' : 'table-row';
            }

            return {
                init: function () {
                    var inputs = document.getElementsByClassName('light-table-filter');
                    Arr.forEach.call(inputs, function (input) {
                        input.oninput = _onInputEvent;
                    });
                }
            };
        })(Array.prototype);

        document.addEventListener('readystatechange', function () {
            if (document.readyState === 'complete') {
                LightTableFilter.init();
            }
        });

    });
    //個人訂單查詢
    //findbymemid找到他的訂單

    //綁 nav-link active 這個button會觸發
    $("#home-tab").click(function () {
        //取得會員id
        let memberId = $("#memberId").text();
        $.ajax({
            url: `/grouporderdetail/list/getbyId/front/emp`,
            type: "GET",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                let td_html = '';
                for (let e in resp) {
                    let groupProductStatustext = '';
                    switch (resp[e].groupProductStatus) {
                        case 0:
                            groupProductStatustext = '訂單已取消';
                            break;
                        case 1:
                            groupProductStatustext = '付款完成，參團中';
                            break;
                        case 2:
                            groupProductStatustext = '已成團，準備出貨中';
                            break;
                        case 3:
                            groupProductStatustext = '已出貨';
                            break;
                        case 4:
                            groupProductStatustext = '未取貨，退回平台';
                            break;
                        case 5:
                            groupProductStatustext = '已取貨';
                            break;
                        case 6:
                            groupProductStatustext = '流團，退款中';
                            break;
                    }


                    let groupProductPayingText = '';
                    if (resp[e].groupProductPaying == 0) {
                        groupProductPayingText = '信用卡';
                    } else {
                        groupProductPayingText = '匯款';
                    }

                    td_html += `<tr>
  <td colspan="0">
    <a class="btn btn-link" data-bs-toggle="collapse" href="#collapseExample-${resp[e].groupOrderId}" role="button" aria-expanded="false" aria-controls="collapseExample-${resp[e].groupOrderId}">
      ${resp[e].groupOrderId}
    </a>
  </td>
  <td id="memid" style="display: none">${resp[e].memberId}</td>
  <td id="groupProductStatus">${groupProductStatustext}</td>
  <td id="groupproductpaying">${groupProductPayingText}</td>
  <td id="grouporderamount">${resp[e].groupOrderAmount}</td>
  <td id="groupproductpaying">${resp[e].groupProductPrice}</td>
  <td id="producttotal">${resp[e].groupOrderAmount * resp[e].groupProductPrice}</td>

</tr>
<tr>
  <td colspan="7">
    <div class="collapse" id="collapseExample-${resp[e].groupOrderId}">
      <div class="card card-body" style="padding-left: 10px;">
        收件者姓名:<span class="my-span" id="receiverName">${resp[e].receiverName}</span>
        收件者電話:<span class="my-span" id="receiverPhone">${resp[e].receiverPhone}</span>
        收件者地址:<span class="my-span" id="receiverAddress">${resp[e].receiverAddress}</span>
        收件者信箱:<span class="my-span" id="receiverEmail">${resp[e].receiverEmail}</span>
        訂單備註::<span class="my-span" id="groupProductOthers">${resp[e].groupProductOthers}</span>

      </div>
    </div>
  </td>
</tr>`;
                }

                $("#grouporderdetail").html(td_html);

            },
            error: function (xhr, textstatus, errorThrown) {
                console.error(xhr);
            }
        });
    });

    $("#home-tab").click();

    $("#profile-tab").click(function () {
        let memberId = $("#memberId").text();
        $.ajax({
            url: `/groupOrder/groupOrderMem/single/`,
            type: "GET",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                let html = '';
                for (let e in resp) {

                    let groupProductStatustext = '';
                    switch (resp[e].groupOrderStatus) {
                        case 0:
                            groupOrderStatustext = '尚未達到開團時間';
                            break;
                        case 1:
                            groupOrderStatustext = '團購進行中，目前團購商品下訂總數不足';
                            break;
                        case 2:
                            groupOrderStatustext = '團購進行中，目前團購商品下訂總數已達標';
                            break;
                        case 3:
                            groupOrderStatustext = '團購關閉，出貨處理中';
                            break;
                        case 4:
                            groupOrderStatustext = '團購關閉，已出貨';
                            break;
                        case 5:
                            groupOrderStatustext = '團購結束。團購時間逾期且團購商品下訂總數不足';
                            break;
                        case 6:
                            groupOrderStatustext = '團購結束。訂單已完成';
                            break;
                    }


                    html += `<div class="col-lg-4 col-md-6">
                   <div class="single-news">
                    <a href='/groupOrder/groupOrderMem/single/detail?groupActivityId=${resp[e].activityId}&groupStatus=${resp[e].groupOrderStatus}'>
                    <img  src="/groupProduct/get/img/${resp[e].groupProductId}" alt="Image" >
                    </a>
                    <div class="news-content">
                    <span class="tag" id="groupOrderStatus"> ${groupOrderStatustext}  </span>
                    <a href="grouporder.html">
                    <h3 id="groupName">${resp[e].groupName} </h3>
                    </a>
                    <ul class="lessons">
                    團購開始時間:<li class="float" id="groupOrderStar"> ${resp[e].groupOrderStar}</li>
                    </ul>
                    <ul class="lessons">
                    團購結束時間:<li class="float" id="groupOrderEnd"> ${resp[e].groupOrderEnd}</li>
                    </ul>
                    </div>
                    </div>
                    </div>`;
                }
                $('#groupOrderContainer').html(html);
            },
            error: function (xhr, textstatus, errorThrown) {
                console.error(xhr);
            }
        })
    })

    //查詢團購主分潤
    $("#contact-tab").click(function () {
        $.ajax({
            url: '/groupbonusfront/memberId',
            type: "GET",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                let td_html = '';
                for (let e in resp) {
                    let groupProductStatustext = '';
                    switch (resp[e].groupOrderStatus) {
                        case 0:
                            groupOrderStatustext = '尚未達到開團時間';
                            break;
                        case 1:
                            groupOrderStatustext = '團購進行中，目前團購商品下訂總數不足';
                            break;
                        case 2:
                            groupOrderStatustext = '團購進行中，目前團購商品下訂總數已達標';
                            break;
                        case 3:
                            groupOrderStatustext = '團購關閉，出貨處理中';
                            break;
                        case 4:
                            groupOrderStatustext = '團購關閉，已出貨';
                            break;
                        case 5:
                            groupOrderStatustext = '團購結束。團購時間逾期且團購商品下訂總數不足';
                            break;
                        case 6:
                            groupOrderStatustext = '團購結束。訂單已完成';
                            break;
                    }

                    let groupOrderBonusText = '';
                    switch (resp[e].groupOrderStatus) {
                        case 0:
                            groupOrderBonusText = '尚未達結算標準';
                            break;
                        case 1:
                            groupOrderBonusText = '尚未達結算標準';
                            break;
                        case 2:
                        case 3:
                        case 4:
                            groupOrderBonusText = '等待結算中';
                            break;
                        case 5:
                            groupOrderBonusText = '已流團';
                            break;
                        case 6:
                            groupOrderBonusText = resp[e].totalGroupProductPrice * resp[e].bonusRate;
                            break;
                    }
                    let groupOrderBonusStatusText = '';
                    if (resp[e].groupOrderBonusStatus == 0) {
                        groupOrderBonusStatusText = '未發放';
                    } else {
                        groupOrderBonusStatusText = '已發放';
                    }


                    td_html += `<tr>
                                    <td id="memId" style="display: none">${resp[e].memberID}</td>

                                    <td id="groupordermaster">
                                        訂單編號:${resp[e].groupOrderId}<br>
                                        訂單成立時間:${resp[e].groupOrderStar}<br>
                                        訂單結束時間:${resp[e].groupOrderEnd}<br >
                                        團購活動編號:${resp[e].activityId}<br>
                                    </td>
                                    <td id="grouporderstatus">${groupOrderStatustext}</td>
                                    <td id="totalgroupproductprice">${resp[e].totalGroupProductPrice}</td>
                                    <td id="groupordermin" >${resp[e].bonusRate}</td>
                                    <td id="grouporderbonus">${groupOrderBonusText}</td>
                                    <td id="grouporderbonusstatus">${groupOrderBonusStatusText} </td>
                                </tr>`;
                }
                $("#grouporderfrontbonus").html(td_html);
            },
            error: function (xhr, textstatus, errorThrown) {
                console.error(xhr);
            }
        });
    });


</script>
</html>